(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{PHTE:function(t,e,a){"use strict";var n={name:"ImageUploadInput",props:{value:{required:!0},private:{default:1}},data:function(){return{flags:{upload:!1},uploaded:0}},computed:{noimage:function(){return null==this.value}},methods:{uploadFile:function(t){var e=this,a=t.target;if(0===a.files.length)return Toast.fire("Error","No ha seleccionado una imagen.","error"),!1;var n=new FormData;n.append("imagen",a.files[0]),n.append("private",this.private),this.flags.upload=!0,axios.post("/upload/image",n,{onUploadProgress:this.onProgress,noloading:!0}).then((function(t){e.$emit("input",t.data.url)})).finally((function(){e.flags.upload=!1,e.uploaded=0,a.value=""}))},onProgress:function(t){this.uploaded=t.loaded/t.total*100}}},o=(a("zeGi"),a("KHd+")),i=Object(o.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("label",{staticClass:"foto-upload d-flex",attrs:{for:"file_"+t._uid}},[t.noimage&&!t.flags.upload?a("div",{staticClass:"no-image align-self-center text-center"},[a("i",{staticClass:"fas fa-cloud-upload-alt"}),a("br"),t._v("Click para subir imagen.\n        ")]):t.flags.upload?a("div",{staticClass:"no-image align-self-center text-center"},[a("div",{staticClass:"progress"},[a("div",{staticClass:"progress-bar progress-bar-striped progress-bar-animated",style:"width: "+t.uploaded+"%",attrs:{role:"progressbar","aria-valuenow":t.uploaded,"aria-valuemin":"0","aria-valuemax":"100"}},[t._v("Subiendo\n                ")])])]):a("div",{staticClass:"w-100 text-center"},[a("img",{staticClass:"mw-100 mh-100",attrs:{src:t.value,title:"Click para cambiar"}})])]),t._v(" "),a("input",{staticClass:"d-none",attrs:{id:"file_"+t._uid,type:"file",accept:"image/jpeg,image/png"},on:{change:function(e){return t.uploadFile(e)}}})])}),[],!1,null,"2aa3137c",null);e.a=i.exports},THs8:function(t,e,a){var n=a("aoy3");"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(n,o);n.locals&&(t.exports=n.locals)},aoy3:function(t,e,a){(t.exports=a("I1BE")(!1)).push([t.i,"\n.foto-upload[data-v-2aa3137c] {\n    border: dashed 3px #ccc;\n    padding: 2px;\n    height: 190px;\n    cursor: pointer;\n}\n.foto-upload[data-v-2aa3137c]:hover {\n    border-color: #007bfc;\n}\n.foto-upload .no-image[data-v-2aa3137c] {\n    width: 100%;\n}\n",""])},ezjH:function(t,e,a){"use strict";var n=a("r1I2"),o=a.n(n),i=a("NWhu"),s=a("Jc6O"),r={name:"DataTableComponent",components:{Vuetable:o.a,VuetablePagination:i.a},props:{api:{required:!0},fields:{required:!0},perPage:{type:Number,default:15},moreSlots:{default:function(){return[]}},moreParams:{default:function(){return{filterCols:""}}}},data:function(){return{paginationComponent:"vuetable-pagination",paginationInfoTemplate:"Mostrando {from} a {to} de {total} elementos",httpOptions:{headers:{Authorization:"Bearer "+s.a.getters["user/getToken"]}},defaultCss:{wrapperClass:"mt-2 mb-2 sg-paginator text-right",activeClass:"active",disabledClass:"disabled",pageClass:"btn btn-light ml-1",linkClass:"btn btn-light",paginationClass:"",paginationInfoClass:"",dropdownClass:"",icons:{first:"fa fa-angle-double-left",prev:"fa fa-angle-left",next:"fa fa-angle-right",last:"fa fa-angle-double-right"}},flags:{inProccess:!1}}},methods:{onPaginationData:function(t){this.$refs.pagination.setPaginationData(t)},onChangePage:function(t){this.$refs.vuetable.changePage(t)},refresh:function(){this.$refs.vuetable.reload()},filterCols:function(t){this.moreParams.filterCols=t,this.$refs.vuetable.refresh()},search:function(t){this.moreParams.search=t,this.$refs.vuetable.refresh()}}},l=a("KHd+"),u=Object(l.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.fields.length>0?a("section",{staticClass:"table-responsive"},[a("vuetable",{ref:"vuetable",staticClass:"table header-border table-striped",attrs:{"api-url":t.api,fields:t.fields,"data-path":"data","pagination-path":"","ascending-icon":"fa fa-sort-amount-asc","descending-icon":"fa fa-sort-amount-desc","per-page":t.perPage,"loading-class":"loading-div","append-params":t.moreParams,"http-options":t.httpOptions},on:{"vuetable:pagination-data":t.onPaginationData,"vuetable:loading":function(e){return t.$store.commit("loading")},"vuetable:loaded":function(e){return t.$store.commit("endLoading")}},scopedSlots:t._u([{key:"actions",fn:function(e){var n=e.rowData;return[void 0!==n.acl?a("div",{staticClass:"text-center"},[a("div",{staticClass:"btn-group btn-group-sm"},[t._t("actionicon",null,{rowData:n}),t._v(" "),n.acl.show?a("button",{staticClass:"btn btn-outline-primary",attrs:{title:"Ver"},on:{click:function(e){return t.$parent.actionsExe("show",n)}}},[a("i",{staticClass:"fa fa-eye"})]):t._e(),t._v(" "),n.acl.update?a("button",{staticClass:"btn btn-outline-primary",attrs:{title:"Editar"},on:{click:function(e){return t.$parent.actionsExe("update",n)}}},[a("i",{staticClass:"fa fa-edit"})]):t._e(),t._v(" "),n.acl.delete?a("button",{staticClass:"btn btn-outline-primary",attrs:{title:"Eliminar"},on:{click:function(e){return t.$parent.actionsExe("delete",n)}}},[a("i",{staticClass:"fa fa-trash"})]):t._e()],2)]):t._e()]}},t._l(t.moreSlots,(function(e){return{key:e,fn:function(a){var n=a.rowData;return[t._t(e,null,{rowData:n})]}}}))],null,!0)})],1):t._e(),t._v(" "),a("vuetable-pagination",{ref:"pagination",attrs:{css:t.defaultCss},on:{"vuetable-pagination:change-page":t.onChangePage}})],1)}),[],!1,null,"556b5e14",null).exports,d={name:"DataCrudComponent",props:{elementName:{default:"Elemento"},default:{required:!0},endpoint:{required:!0},modalLg:{default:!1},primaryKey:{default:"id"}},data:function(){return{type:"store",comp_id:null,document:null,uid:0,errors:{}}},computed:{title:function(){return"show"===this.type?"Detalles de "+this.elementName:"update"===this.type?"Modificar "+this.elementName:"Crear "+this.elementName}},mounted:function(){this.comp_id=this._uid},methods:{showModal:function(){this.errors={},$("#modal"+this._uid).modal("show")},hideModal:function(){$("#modal"+this._uid).modal("hide")},actions:function(t,e){this.reset(),this.type=t,"show"===t||"update"===t?(this.document=_.merge(this.document,e),this.showModal()):"delete"===t?this.deleteElement(e):this.showModal()},reset:function(){this.document=JSON.parse(JSON.stringify(this.default))},deleteElement:function(t){var e=this;sgConfirm("Atención","¿Está seguro de eliminar este elemento?","Si, Eliminar",(function(){axios.delete(e.endpoint+"/"+t.id).then((function(t){Toast.fire("Felicitaciones","Se ha eliminado correctamente.","success"),e.$emit("save","success"),e.hideModal()}))}))},saveDocument:function(){var t=this,e="post",a=this.endpoint;"update"===this.type&&(a=a+"/"+this.document[this.primaryKey],e="patch"),axios[e](a,this.document).then((function(e){Toast.fire("Felicitaciones","Se ha guardado correctamente.","success"),t.$emit("save","success"),t.hideModal()}),(function(e){void 0!==e.data.errors&&(t.errors=e.data.errors),console.log("hay un error",e.data)}))}}},c=Object(l.a)(d,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal fade",attrs:{id:"modal"+t._uid,tabindex:"-10",role:"dialog","aria-hidden":"true"}},[a("div",{class:t.modalLg?"modal-dialog modal-lg":"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v(t._s(t.title))]),t._v(" "),t._m(0)]),t._v(" "),null!=t.document?a("div",{staticClass:"modal-body"},["show"!==t.type?t._t("storeupdate",[t._v("Here content Store Update")],{document:t.document,errors:t.errors}):t._t("show",[t._v("Here content show")],{document:t.document})],2):t._e(),t._v(" "),a("div",{staticClass:"modal-footer"},[a("div",{staticClass:"text-left",staticStyle:{flex:"auto"}},["update"===t.type?a("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(e){return t.deleteElement(t.document)}}},[t._v("Eliminar")]):t._e()]),t._v(" "),a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Cerrar")]),t._v(" "),"show"!==t.type?a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.saveDocument()}}},[t._v("Guardar")]):t._e()])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])}],!1,null,"7c144e6b",null).exports,m=a("LvDl"),p={name:"ListPageComponent",components:{DataCrudComponent:c,DataTableComponent:u},props:{moreParams:{default:function(){return{filterCols:""}}},headerTitle:{default:""},tableFields:{default:function(){return[]}},customTable:{default:null},endpoint:{default:null},elementName:{required:!0},elementDefault:{required:!0},modalLg:{default:!1},primaryKey:{default:"id"},permissions:{default:function(){return{create:!0}}},groups:[{title:"Todos",moreParams:{filterCols:""}},{title:"Ejecutivos",moreParams:"email,juan@test.com,text"}]},data:function(){return{apiRoot:"/",search:"",paginate:["filteredItems"],items:[],loadedTableFields:[],keyList:0}},computed:{tableFieldsComputed:function(){return null!=this.customTable?this.loadedTableFields:this.tableFields}},watch:{search:function(t){this.onSearch(t,this)}},methods:{onSearch:m.debounce((function(t,e){e.$refs.dataTable.search(t)}),350),onSave:function(t){this.$refs.dataTable.refresh(),this.$emit("onSave",t)},onErrorInput:function(t){console.log(t)},actionsExe:function(t,e){"show"===t&&void 0!==this.$parent.onActionShow?this.$parent.onActionShow(e):"update"===t&&void 0!==this.$parent.onActionUpdate?this.$parent.onActionUpdate(e):"store"===t&&void 0!==this.$parent.onActionStore?this.$parent.onActionStore(e):this.$refs.crudModal.actions(t,e)},reloadTable:function(){var t=this;this.loadTableFields().then((function(){t.keyList+=1}))},callbackTags:function(t){var e="";return m.forEach(t,(function(t){return e+='<span class="badge badge-secondary">'+t+"</span>"})),e}}},f=Object(l.a)(p,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-card",{attrs:{header:t.headerTitle}},[a("b-row",[a("b-col",{attrs:{cols:"12"}},[a("div",{staticClass:"form-group form-inline pull-right"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"search",placeholder:"Buscar"},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}}),t._v("\n         "),t.permissions.create?a("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.actionsExe("store")}}},[t._v("Nuevo")]):t._e(),t._v(" "),t._t("buttons")],2),t._v(" "),a("div",{staticClass:"clearfix"}),t._v(" "),a("div",[a("ul",{staticClass:"nav nav-tabs"},[t._t("nav-tabs",[a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link active",attrs:{href:"#"}},[t._v("Todos")])])])],2),t._v(" "),a("div",{staticClass:"tab-content p-4"},[a("data-table-component",{key:t.keyList,ref:"dataTable",attrs:{"more-params":t.moreParams,api:t.apiRoot+t.endpoint,fields:t.tableFieldsComputed},scopedSlots:t._u([{key:"actionicon",fn:function(e){var a=e.rowData;return[t._t("actionicon",null,{rowData:a})]}}],null,!0)})],1)])])],1),t._v(" "),a("div",[a("data-crud-component",{ref:"crudModal",attrs:{"element-name":t.elementName,default:t.elementDefault,endpoint:t.endpoint,"modal-lg":t.modalLg,"primary-key":t.primaryKey},on:{save:t.onSave},scopedSlots:t._u([{key:"storeupdate",fn:function(e){var a=e.document,n=e.errors;return[t._t("storeupdate",null,{document:a,errors:n})]}},{key:"show",fn:function(e){var a=e.document;return[t._t("show",null,{document:a})]}}],null,!0)})],1)],1)}),[],!1,null,"0fc9b0ba",null);e.a=f.exports},"j4+6":function(t,e,a){"use strict";var n=a("x6DR"),o={name:"TagsInput",props:{value:{default:""},tags:{default:function(){return[]}},config:{default:function(){return{endpoint:"",valueField:"name"}}}},components:{VueTagsInput:a.n(n).a},data:function(){return{tag:"",tagsInternal:[],items:[]}},mounted:function(){this.tags.length>0&&this.tagsMapping(this.tags)},watch:{tags:"tagsMapping",tag:function(t){this.onSearch(t)}},methods:{tagChanged:function(t){this.tagsInternal=t,this.$emit("tags-changed",_.map(t,(function(t){return t.text})))},tagsMapping:function(t){this.tagsInternal=_.map(t,(function(t){return{text:t}}))},onSearch:function(t){this.search(t,this)},search:_.debounce((function(t,e){api.get(e.config.endpoint+"?search="+t,{noloading:!0}).then((function(t){var a=t.data;e.items=_.map(a.data,(function(t){return{text:t.name.es}}))}))}),350)}},i=a("KHd+"),s=Object(i.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("vue-tags-input",{attrs:{tags:t.tagsInternal,"autocomplete-items":t.items},on:{"tags-changed":t.tagChanged},model:{value:t.tag,callback:function(e){t.tag=e},expression:"tag"}})],1)}),[],!1,null,"568b3e65",null).exports,r={name:"FormComponent",components:{ImageUploadInput:a("PHTE").a,TagInput:s},props:{schema:{default:function(){return{}}},errors:{default:function(){return[]}},document:{required:!0},prefixError:{default:""}},methods:{isHtmlTag:function(t){return"text"===t||"password"===t||"email"===t||"number"===t},isInvalid:function(t){return console.log("is invalid",this.prefixError+t),void 0!==this.errors[this.prefixError+t]},isInvalidClass:function(t){return this.isInvalid(t)?" is-invalid":""}}},l={name:"FormDynamicComponent",components:{FormComponent:Object(i.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},t._l(t.schema,(function(e){return a("div",{class:e.class||"col-lg-12"},[a("div",{staticClass:"form-group"},[a("label",[t._v(t._s(e.title))]),t._v(" "),"checkbox"===e.type&&t.isHtmlTag(e.type)?a("input",{directives:[{name:"model",rawName:"v-model",value:t.document[e.bind],expression:"document[input.bind]"}],class:"form-control"+t.isInvalidClass(e.bind),attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.document[e.bind])?t._i(t.document[e.bind],null)>-1:t.document[e.bind]},on:{change:function(a){var n=t.document[e.bind],o=a.target,i=!!o.checked;if(Array.isArray(n)){var s=t._i(n,null);o.checked?s<0&&t.$set(t.document,e.bind,n.concat([null])):s>-1&&t.$set(t.document,e.bind,n.slice(0,s).concat(n.slice(s+1)))}else t.$set(t.document,e.bind,i)}}}):"radio"===e.type&&t.isHtmlTag(e.type)?a("input",{directives:[{name:"model",rawName:"v-model",value:t.document[e.bind],expression:"document[input.bind]"}],class:"form-control"+t.isInvalidClass(e.bind),attrs:{type:"radio"},domProps:{checked:t._q(t.document[e.bind],null)},on:{change:function(a){return t.$set(t.document,e.bind,null)}}}):t.isHtmlTag(e.type)?a("input",{directives:[{name:"model",rawName:"v-model",value:t.document[e.bind],expression:"document[input.bind]"}],class:"form-control"+t.isInvalidClass(e.bind),attrs:{type:e.type},domProps:{value:t.document[e.bind]},on:{input:function(a){a.target.composing||t.$set(t.document,e.bind,a.target.value)}}}):"select"===e.type?a("select",{directives:[{name:"model",rawName:"v-model",value:t.document[e.bind],expression:"document[input.bind]"}],class:"form-control"+t.isInvalidClass(e.bind),on:{change:function(a){var n=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.document,e.bind,a.target.multiple?n:n[0])}}},[a("option",{domProps:{value:null}},[t._v("-- Seleccione --")]),t._v(" "),t._l(e.options,(function(e){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])}))],2):"boolean"===e.type?a("select",{directives:[{name:"model",rawName:"v-model",value:t.document[e.bind],expression:"document[input.bind]"}],class:"form-control"+t.isInvalidClass(e.bind),on:{change:function(a){var n=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.document,e.bind,a.target.multiple?n:n[0])}}},[a("option",{domProps:{value:null}},[t._v("-- Seleccione --")]),t._v(" "),a("option",{attrs:{value:"1"}},[t._v("SI")]),t._v(" "),a("option",{attrs:{value:"0"}},[t._v("NO")])]):"textarea"===e.type?a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.document[e.bind],expression:"document[input.bind]"}],class:"form-control"+t.isInvalidClass(e.bind),attrs:{rows:"5"},domProps:{value:t.document[e.bind]},on:{input:function(a){a.target.composing||t.$set(t.document,e.bind,a.target.value)}}}):"image"===e.type?a("image-upload-input",{attrs:{private:0},model:{value:t.document[e.bind],callback:function(a){t.$set(t.document,e.bind,a)},expression:"document[input.bind]"}}):"tags"===e.type?a("tag-input",{attrs:{tags:t.document[e.bind],config:e.config},on:{"tags-changed":function(a){return t.document[e.bind]=a}}}):t._e(),t._v(" "),void 0!==e.info?a("small",{staticClass:"form-text text-muted"},[t._v("\n        "+t._s(e.info)+"\n      ")]):t._e(),t._v(" "),t.isInvalid(e.bind)?a("div",{staticClass:"invalid-feedback"},[t._v("\n        "+t._s(t.errors[t.prefixError+e.bind][0])+"\n      ")]):t._e()],1)])})),0)}),[],!1,null,"41598568",null).exports},props:{endpoint:{required:!0,default:null},document:{required:!0,default:function(){return null}},errors:{default:function(){return[]}},toggle:{default:!1}},data:function(){return{forms:[],show:!1}},computed:{hiddenTab:function(){return!0===this.toggle&&!this.show}},mounted:function(){this.getFormData()},methods:{getFormData:function(){var t=this;axios.get(this.endpoint).then((function(e){var a=e.data;t.forms=a}))},toggleTab:function(){this.show=!this.show}}},u=Object(i.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-tabs",t._l(t.forms,(function(e){return a("b-tab",{key:e.title,attrs:{hidden:t.hiddenTab},scopedSlots:t._u([{key:"title",fn:function(){return[a("div",{on:{click:function(e){return t.toggleTab()}}},[t._v("\n        "+t._s(e.title)+"\n        "),t.toggle?a("span",[t.show?a("i",{staticClass:"fa fa-angle-left"}):a("i",{staticClass:"fa fa-angle-down"})]):t._e()])]},proxy:!0}],null,!0)},[t._v(" "),null===e.prefix?a("form-component",{attrs:{schema:e.inputs,errors:t.errors,document:t.document}}):a("form-component",{attrs:{schema:e.inputs,errors:t.errors,document:t.document[e.prefix],"prefix-error":e.prefix+"."}}),t._v(" "),t._t("default")],2)})),1)}),[],!1,null,"265be980",null);e.a=u.exports},zeGi:function(t,e,a){"use strict";var n=a("THs8");a.n(n).a}}]);